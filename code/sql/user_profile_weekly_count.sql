CREATE TABLE user_profile_weekly_count AS
(
    SELECT 
    user_id,
    
    SUM(CASE WHEN (action_type = 0) AND (time_stamp BETWEEN '0512' AND '0518') THEN 1 ELSE 0 END) AS week_01_click,
    SUM(CASE WHEN (action_type = 0) AND (time_stamp BETWEEN '0519' AND '0525') THEN 1 ELSE 0 END) AS week_02_click,
    SUM(CASE WHEN (action_type = 0) AND (time_stamp BETWEEN '0526' AND '0601') THEN 1 ELSE 0 END) AS week_03_click,
    SUM(CASE WHEN (action_type = 0) AND (time_stamp BETWEEN '0602' AND '0608') THEN 1 ELSE 0 END) AS week_04_click,
    SUM(CASE WHEN (action_type = 0) AND (time_stamp BETWEEN '0609' AND '0615') THEN 1 ELSE 0 END) AS week_05_click,
    SUM(CASE WHEN (action_type = 0) AND (time_stamp BETWEEN '0616' AND '0622') THEN 1 ELSE 0 END) AS week_06_click,
    SUM(CASE WHEN (action_type = 0) AND (time_stamp BETWEEN '0623' AND '0629') THEN 1 ELSE 0 END) AS week_07_click,
    SUM(CASE WHEN (action_type = 0) AND (time_stamp BETWEEN '0630' AND '0706') THEN 1 ELSE 0 END) AS week_08_click,
    SUM(CASE WHEN (action_type = 0) AND (time_stamp BETWEEN '0707' AND '0713') THEN 1 ELSE 0 END) AS week_09_click,
    SUM(CASE WHEN (action_type = 0) AND (time_stamp BETWEEN '0714' AND '0720') THEN 1 ELSE 0 END) AS week_10_click,
    SUM(CASE WHEN (action_type = 0) AND (time_stamp BETWEEN '0721' AND '0727') THEN 1 ELSE 0 END) AS week_11_click,
    SUM(CASE WHEN (action_type = 0) AND (time_stamp BETWEEN '0728' AND '0803') THEN 1 ELSE 0 END) AS week_12_click,
    SUM(CASE WHEN (action_type = 0) AND (time_stamp BETWEEN '0804' AND '0810') THEN 1 ELSE 0 END) AS week_13_click,
    SUM(CASE WHEN (action_type = 0) AND (time_stamp BETWEEN '0811' AND '0817') THEN 1 ELSE 0 END) AS week_14_click,
    SUM(CASE WHEN (action_type = 0) AND (time_stamp BETWEEN '0818' AND '0824') THEN 1 ELSE 0 END) AS week_15_click,
    SUM(CASE WHEN (action_type = 0) AND (time_stamp BETWEEN '0825' AND '0831') THEN 1 ELSE 0 END) AS week_16_click,
    SUM(CASE WHEN (action_type = 0) AND (time_stamp BETWEEN '0901' AND '0907') THEN 1 ELSE 0 END) AS week_17_click,
    SUM(CASE WHEN (action_type = 0) AND (time_stamp BETWEEN '0908' AND '0914') THEN 1 ELSE 0 END) AS week_18_click,
    SUM(CASE WHEN (action_type = 0) AND (time_stamp BETWEEN '0915' AND '0921') THEN 1 ELSE 0 END) AS week_19_click,
    SUM(CASE WHEN (action_type = 0) AND (time_stamp BETWEEN '0922' AND '0928') THEN 1 ELSE 0 END) AS week_20_click,
    SUM(CASE WHEN (action_type = 0) AND (time_stamp BETWEEN '0929' AND '1005') THEN 1 ELSE 0 END) AS week_21_click,
    SUM(CASE WHEN (action_type = 0) AND (time_stamp BETWEEN '1006' AND '1012') THEN 1 ELSE 0 END) AS week_22_click,
    SUM(CASE WHEN (action_type = 0) AND (time_stamp BETWEEN '1013' AND '1019') THEN 1 ELSE 0 END) AS week_23_click,
    SUM(CASE WHEN (action_type = 0) AND (time_stamp BETWEEN '1020' AND '1026') THEN 1 ELSE 0 END) AS week_24_click,
    SUM(CASE WHEN (action_type = 0) AND (time_stamp BETWEEN '1027' AND '1102') THEN 1 ELSE 0 END) AS week_25_click,
    SUM(CASE WHEN (action_type = 0) AND (time_stamp BETWEEN '1103' AND '1109') THEN 1 ELSE 0 END) AS week_26_click,
    
    SUM(CASE WHEN (action_type = 1) AND (time_stamp BETWEEN '0512' AND '0518') THEN 1 ELSE 0 END) AS week_01_cart,
    SUM(CASE WHEN (action_type = 1) AND (time_stamp BETWEEN '0519' AND '0525') THEN 1 ELSE 0 END) AS week_02_cart,
    SUM(CASE WHEN (action_type = 1) AND (time_stamp BETWEEN '0526' AND '0601') THEN 1 ELSE 0 END) AS week_03_cart,
    SUM(CASE WHEN (action_type = 1) AND (time_stamp BETWEEN '0602' AND '0608') THEN 1 ELSE 0 END) AS week_04_cart,
    SUM(CASE WHEN (action_type = 1) AND (time_stamp BETWEEN '0609' AND '0615') THEN 1 ELSE 0 END) AS week_05_cart,
    SUM(CASE WHEN (action_type = 1) AND (time_stamp BETWEEN '0616' AND '0622') THEN 1 ELSE 0 END) AS week_06_cart,
    SUM(CASE WHEN (action_type = 1) AND (time_stamp BETWEEN '0623' AND '0629') THEN 1 ELSE 0 END) AS week_07_cart,
    SUM(CASE WHEN (action_type = 1) AND (time_stamp BETWEEN '0630' AND '0706') THEN 1 ELSE 0 END) AS week_08_cart,
    SUM(CASE WHEN (action_type = 1) AND (time_stamp BETWEEN '0707' AND '0713') THEN 1 ELSE 0 END) AS week_09_cart,
    SUM(CASE WHEN (action_type = 1) AND (time_stamp BETWEEN '0714' AND '0720') THEN 1 ELSE 0 END) AS week_10_cart,
    SUM(CASE WHEN (action_type = 1) AND (time_stamp BETWEEN '0721' AND '0727') THEN 1 ELSE 0 END) AS week_11_cart,
    SUM(CASE WHEN (action_type = 1) AND (time_stamp BETWEEN '0728' AND '0803') THEN 1 ELSE 0 END) AS week_12_cart,
    SUM(CASE WHEN (action_type = 1) AND (time_stamp BETWEEN '0804' AND '0810') THEN 1 ELSE 0 END) AS week_13_cart,
    SUM(CASE WHEN (action_type = 1) AND (time_stamp BETWEEN '0811' AND '0817') THEN 1 ELSE 0 END) AS week_14_cart,
    SUM(CASE WHEN (action_type = 1) AND (time_stamp BETWEEN '0818' AND '0824') THEN 1 ELSE 0 END) AS week_15_cart,
    SUM(CASE WHEN (action_type = 1) AND (time_stamp BETWEEN '0825' AND '0831') THEN 1 ELSE 0 END) AS week_16_cart,
    SUM(CASE WHEN (action_type = 1) AND (time_stamp BETWEEN '0901' AND '0907') THEN 1 ELSE 0 END) AS week_17_cart,
    SUM(CASE WHEN (action_type = 1) AND (time_stamp BETWEEN '0908' AND '0914') THEN 1 ELSE 0 END) AS week_18_cart,
    SUM(CASE WHEN (action_type = 1) AND (time_stamp BETWEEN '0915' AND '0921') THEN 1 ELSE 0 END) AS week_19_cart,
    SUM(CASE WHEN (action_type = 1) AND (time_stamp BETWEEN '0922' AND '0928') THEN 1 ELSE 0 END) AS week_20_cart,
    SUM(CASE WHEN (action_type = 1) AND (time_stamp BETWEEN '0929' AND '1005') THEN 1 ELSE 0 END) AS week_21_cart,
    SUM(CASE WHEN (action_type = 1) AND (time_stamp BETWEEN '1006' AND '1012') THEN 1 ELSE 0 END) AS week_22_cart,
    SUM(CASE WHEN (action_type = 1) AND (time_stamp BETWEEN '1013' AND '1019') THEN 1 ELSE 0 END) AS week_23_cart,
    SUM(CASE WHEN (action_type = 1) AND (time_stamp BETWEEN '1020' AND '1026') THEN 1 ELSE 0 END) AS week_24_cart,
    SUM(CASE WHEN (action_type = 1) AND (time_stamp BETWEEN '1027' AND '1102') THEN 1 ELSE 0 END) AS week_25_cart,
    SUM(CASE WHEN (action_type = 1) AND (time_stamp BETWEEN '1103' AND '1109') THEN 1 ELSE 0 END) AS week_26_cart,
    
    SUM(CASE WHEN (action_type = 2) AND (time_stamp BETWEEN '0512' AND '0518') THEN 1 ELSE 0 END) AS week_01_purchase,
    SUM(CASE WHEN (action_type = 2) AND (time_stamp BETWEEN '0519' AND '0525') THEN 1 ELSE 0 END) AS week_02_purchase,
    SUM(CASE WHEN (action_type = 2) AND (time_stamp BETWEEN '0526' AND '0601') THEN 1 ELSE 0 END) AS week_03_purchase,
    SUM(CASE WHEN (action_type = 2) AND (time_stamp BETWEEN '0602' AND '0608') THEN 1 ELSE 0 END) AS week_04_purchase,
    SUM(CASE WHEN (action_type = 2) AND (time_stamp BETWEEN '0609' AND '0615') THEN 1 ELSE 0 END) AS week_05_purchase,
    SUM(CASE WHEN (action_type = 2) AND (time_stamp BETWEEN '0616' AND '0622') THEN 1 ELSE 0 END) AS week_06_purchase,
    SUM(CASE WHEN (action_type = 2) AND (time_stamp BETWEEN '0623' AND '0629') THEN 1 ELSE 0 END) AS week_07_purchase,
    SUM(CASE WHEN (action_type = 2) AND (time_stamp BETWEEN '0630' AND '0706') THEN 1 ELSE 0 END) AS week_08_purchase,
    SUM(CASE WHEN (action_type = 2) AND (time_stamp BETWEEN '0707' AND '0713') THEN 1 ELSE 0 END) AS week_09_purchase,
    SUM(CASE WHEN (action_type = 2) AND (time_stamp BETWEEN '0714' AND '0720') THEN 1 ELSE 0 END) AS week_10_purchase,
    SUM(CASE WHEN (action_type = 2) AND (time_stamp BETWEEN '0721' AND '0727') THEN 1 ELSE 0 END) AS week_11_purchase,
    SUM(CASE WHEN (action_type = 2) AND (time_stamp BETWEEN '0728' AND '0803') THEN 1 ELSE 0 END) AS week_12_purchase,
    SUM(CASE WHEN (action_type = 2) AND (time_stamp BETWEEN '0804' AND '0810') THEN 1 ELSE 0 END) AS week_13_purchase,
    SUM(CASE WHEN (action_type = 2) AND (time_stamp BETWEEN '0811' AND '0817') THEN 1 ELSE 0 END) AS week_14_purchase,
    SUM(CASE WHEN (action_type = 2) AND (time_stamp BETWEEN '0818' AND '0824') THEN 1 ELSE 0 END) AS week_15_purchase,
    SUM(CASE WHEN (action_type = 2) AND (time_stamp BETWEEN '0825' AND '0831') THEN 1 ELSE 0 END) AS week_16_purchase,
    SUM(CASE WHEN (action_type = 2) AND (time_stamp BETWEEN '0901' AND '0907') THEN 1 ELSE 0 END) AS week_17_purchase,
    SUM(CASE WHEN (action_type = 2) AND (time_stamp BETWEEN '0908' AND '0914') THEN 1 ELSE 0 END) AS week_18_purchase,
    SUM(CASE WHEN (action_type = 2) AND (time_stamp BETWEEN '0915' AND '0921') THEN 1 ELSE 0 END) AS week_19_purchase,
    SUM(CASE WHEN (action_type = 2) AND (time_stamp BETWEEN '0922' AND '0928') THEN 1 ELSE 0 END) AS week_20_purchase,
    SUM(CASE WHEN (action_type = 2) AND (time_stamp BETWEEN '0929' AND '1005') THEN 1 ELSE 0 END) AS week_21_purchase,
    SUM(CASE WHEN (action_type = 2) AND (time_stamp BETWEEN '1006' AND '1012') THEN 1 ELSE 0 END) AS week_22_purchase,
    SUM(CASE WHEN (action_type = 2) AND (time_stamp BETWEEN '1013' AND '1019') THEN 1 ELSE 0 END) AS week_23_purchase,
    SUM(CASE WHEN (action_type = 2) AND (time_stamp BETWEEN '1020' AND '1026') THEN 1 ELSE 0 END) AS week_24_purchase,
    SUM(CASE WHEN (action_type = 2) AND (time_stamp BETWEEN '1027' AND '1102') THEN 1 ELSE 0 END) AS week_25_purchase,
    SUM(CASE WHEN (action_type = 2) AND (time_stamp BETWEEN '1103' AND '1109') THEN 1 ELSE 0 END) AS week_26_purchase,
    
    SUM(CASE WHEN (action_type = 3) AND (time_stamp BETWEEN '0512' AND '0518') THEN 1 ELSE 0 END) AS week_01_favorite,
    SUM(CASE WHEN (action_type = 3) AND (time_stamp BETWEEN '0519' AND '0525') THEN 1 ELSE 0 END) AS week_02_favorite,
    SUM(CASE WHEN (action_type = 3) AND (time_stamp BETWEEN '0526' AND '0601') THEN 1 ELSE 0 END) AS week_03_favorite,
    SUM(CASE WHEN (action_type = 3) AND (time_stamp BETWEEN '0602' AND '0608') THEN 1 ELSE 0 END) AS week_04_favorite,
    SUM(CASE WHEN (action_type = 3) AND (time_stamp BETWEEN '0609' AND '0615') THEN 1 ELSE 0 END) AS week_05_favorite,
    SUM(CASE WHEN (action_type = 3) AND (time_stamp BETWEEN '0616' AND '0622') THEN 1 ELSE 0 END) AS week_06_favorite,
    SUM(CASE WHEN (action_type = 3) AND (time_stamp BETWEEN '0623' AND '0629') THEN 1 ELSE 0 END) AS week_07_favorite,
    SUM(CASE WHEN (action_type = 3) AND (time_stamp BETWEEN '0630' AND '0706') THEN 1 ELSE 0 END) AS week_08_favorite,
    SUM(CASE WHEN (action_type = 3) AND (time_stamp BETWEEN '0707' AND '0713') THEN 1 ELSE 0 END) AS week_09_favorite,
    SUM(CASE WHEN (action_type = 3) AND (time_stamp BETWEEN '0714' AND '0720') THEN 1 ELSE 0 END) AS week_10_favorite,
    SUM(CASE WHEN (action_type = 3) AND (time_stamp BETWEEN '0721' AND '0727') THEN 1 ELSE 0 END) AS week_11_favorite,
    SUM(CASE WHEN (action_type = 3) AND (time_stamp BETWEEN '0728' AND '0803') THEN 1 ELSE 0 END) AS week_12_favorite,
    SUM(CASE WHEN (action_type = 3) AND (time_stamp BETWEEN '0804' AND '0810') THEN 1 ELSE 0 END) AS week_13_favorite,
    SUM(CASE WHEN (action_type = 3) AND (time_stamp BETWEEN '0811' AND '0817') THEN 1 ELSE 0 END) AS week_14_favorite,
    SUM(CASE WHEN (action_type = 3) AND (time_stamp BETWEEN '0818' AND '0824') THEN 1 ELSE 0 END) AS week_15_favorite,
    SUM(CASE WHEN (action_type = 3) AND (time_stamp BETWEEN '0825' AND '0831') THEN 1 ELSE 0 END) AS week_16_favorite,
    SUM(CASE WHEN (action_type = 3) AND (time_stamp BETWEEN '0901' AND '0907') THEN 1 ELSE 0 END) AS week_17_favorite,
    SUM(CASE WHEN (action_type = 3) AND (time_stamp BETWEEN '0908' AND '0914') THEN 1 ELSE 0 END) AS week_18_favorite,
    SUM(CASE WHEN (action_type = 3) AND (time_stamp BETWEEN '0915' AND '0921') THEN 1 ELSE 0 END) AS week_19_favorite,
    SUM(CASE WHEN (action_type = 3) AND (time_stamp BETWEEN '0922' AND '0928') THEN 1 ELSE 0 END) AS week_20_favorite,
    SUM(CASE WHEN (action_type = 3) AND (time_stamp BETWEEN '0929' AND '1005') THEN 1 ELSE 0 END) AS week_21_favorite,
    SUM(CASE WHEN (action_type = 3) AND (time_stamp BETWEEN '1006' AND '1012') THEN 1 ELSE 0 END) AS week_22_favorite,
    SUM(CASE WHEN (action_type = 3) AND (time_stamp BETWEEN '1013' AND '1019') THEN 1 ELSE 0 END) AS week_23_favorite,
    SUM(CASE WHEN (action_type = 3) AND (time_stamp BETWEEN '1020' AND '1026') THEN 1 ELSE 0 END) AS week_24_favorite,
    SUM(CASE WHEN (action_type = 3) AND (time_stamp BETWEEN '1027' AND '1102') THEN 1 ELSE 0 END) AS week_25_favorite,
    SUM(CASE WHEN (action_type = 3) AND (time_stamp BETWEEN '1103' AND '1109') THEN 1 ELSE 0 END) AS week_26_favorite
    
    FROM user_log
    GROUP BY user_id       
)